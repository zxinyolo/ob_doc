# aws打码调研

>**背景：** 目前已知的使用亚马逊验证码网站较少，目前收集的验证码图片类型有7种，一共有5420张图片（继续收集也都是重复的，因此数据量难以进一步提升）可用样本有限，且类别分布可能存在明显的不均衡。

## 方式1-模型打码

目前采取到的样本数据分类的图片不均衡，有的类型非常多，有的非常少，导致整体数据分布不均衡。
 这种情况会直接影响模型的训练效果和泛化能力

### 可能会导致的问题

- 模型偏向多数类： 在训练时，模型会更倾向于预测样本数多的类别，因为它在训练集出现频率更高，从而导致偏差
- 少数类召回率低：少数类别因为样本稀缺，模型在训练时学到的特征不充分，可能导致预测时漏判或完全忽略少数类
- 泛化能力差：在真实场景中验证码的分布可能与训练集不同，模型在遇到新的或难样本时表现不稳定，准确率下降

## 方式2-基于感知哈希的图像分类对比

> **说明**：感知哈希（Perceptual Hashing, pHash）是一种通过提取图片的全局特征并生成固定长度二进制串的方法，可以用于衡量图像的相似性。
>  **BK-Tree（Burkhard-Keller Tree）** 是一种专门用于度量空间快速搜索的数据结构，特别适合哈希码之间的汉明距离相似性搜索。

### 实现方式

1. **基于现有的分类图片计算每张图片的感知哈希**
   - 将收集到的每一张验证码图片转换为 pHash 值，作为图像的唯一指纹
2. **为每个类别构建独立的BK-Tree，然后持久化保存索引**
   - 每个类别都有一棵树，树中的节点是对应图片的哈希值，方便后续快速搜索
3. **传入图片，计算图片的感知哈希**
   - 在线识别时，先对输入图片进行同样的哈希计算，得到目标哈希值
4. **在所有类别的BK-Tree中搜索最相似的图片**
   - 根据汉明距离，找出最接近的类别候选
5. **计算相似度和置信度**
   - 将最小汉明距离转换为相似度，并结合历史分布给出置信度
6. **返回分类结果**
   - 将置信度最高的类别作为预测结果返回

### 局限性

1. 图片质量依赖：对模糊、噪声图片效果较差
2. 类别数量限制：类别过多时性能下降